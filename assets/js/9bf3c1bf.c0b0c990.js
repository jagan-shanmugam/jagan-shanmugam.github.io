"use strict";(globalThis.webpackChunkjagan_sh=globalThis.webpackChunkjagan_sh||[]).push([[2295],{1407(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var i=t(6404),s=t(4848),r=t(8453),a=t(2352);const o={slug:"DSPy-Intro",title:"Intro to DSPy",description:"Introduction to DSPy - Stanford NLP's declarative framework for programming with language models. Learn how to build composable, optimizable LM pipelines.",authors:["jagan"],tags:["dspy","llm","ai","language models"],keywords:["DSPy","language models","prompt optimization"]},l=void 0,d={authorsImageUrls:[void 0]},c=[{value:"The Problem with Traditional Prompting",id:"the-problem-with-traditional-prompting",level:3},{value:"The DSPy Solution: Declarative Programming",id:"the-dspy-solution-declarative-programming",level:3},{value:"Core Concepts",id:"core-concepts",level:3},{value:"1. <strong>Signatures</strong> - Declare Your Task",id:"1-signatures---declare-your-task",level:4},{value:"2. <strong>Modules</strong> - Build Composable Pipelines",id:"2-modules---build-composable-pipelines",level:4},{value:"3. <strong>Optimizers</strong> - Automatic Prompt and Weight Tuning",id:"3-optimizers---automatic-prompt-and-weight-tuning",level:4},{value:"Why Declarative? The React/SQL Analogy",id:"why-declarative-the-reactsql-analogy",level:3},{value:"Real-World Use Cases",id:"real-world-use-cases",level:3},{value:"DSPy Architecture",id:"dspy-architecture",level:3},{value:"Getting Started",id:"getting-started",level:3},{value:"When to/not to use DSPy",id:"when-tonot-to-use-dspy",level:3},{value:"The Future: Foundation Models Need Foundation Frameworks",id:"the-future-foundation-models-need-foundation-frameworks",level:3},{value:"Further Reading",id:"further-reading",level:3}];function h(e){const n={a:"a",code:"code",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"DSPy"})," (Declarative Self-improving Python) is a revolutionary framework developed by Stanford NLP that fundamentally changes how we build applications with Language Models (LMs).\nInstead of manually crafting and tweaking prompts, DSPy lets you ",(0,s.jsx)(n.strong,{children:"declare what you want"})," and automatically optimizes ",(0,s.jsx)(n.strong,{children:"how to achieve it"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Think of DSPy as the ",(0,s.jsx)(n.strong,{children:"SQL for language models"})," - just as SQL lets you declare what data you want without specifying how to retrieve it, DSPy lets you declare your LM pipeline logic without manually engineering prompts."]}),"\n",(0,s.jsx)(n.h3,{id:"the-problem-with-traditional-prompting",children:"The Problem with Traditional Prompting"}),"\n",(0,s.jsxs)(n.p,{children:["Traditional LM application development is ",(0,s.jsx)(n.strong,{children:"brittle and time-consuming"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# Traditional approach - manually crafted prompt\nprompt = """\nYou are a helpful assistant. Given a question and context,\nprovide a clear and concise answer.\n\nContext: {context}\nQuestion: {question}\n\nAnswer:\n"""\nresponse = llm(prompt.format(context=ctx, question=query))\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Problems:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Manual prompt engineering for every task"}),"\n",(0,s.jsx)(n.li,{children:"Hard to optimize - requires extensive trial and error"}),"\n",(0,s.jsx)(n.li,{children:"Difficult to compose complex pipelines"}),"\n",(0,s.jsx)(n.li,{children:"Breaks when you change LM providers"}),"\n",(0,s.jsx)(n.li,{children:"No systematic way to improve performance"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"the-dspy-solution-declarative-programming",children:"The DSPy Solution: Declarative Programming"}),"\n",(0,s.jsxs)(n.p,{children:["DSPy introduces a ",(0,s.jsx)(n.strong,{children:"declarative, modular approach"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import dspy\n\n# 1. Define your task signature (declare what you want)\nclass QA(dspy.Signature):\n    """Answer questions with short factual answers."""\n    context = dspy.InputField()\n    question = dspy.InputField()\n    answer = dspy.OutputField(desc="often between 1 and 5 words")\n\n# 2. Create a module (declare your pipeline)\nclass RAG(dspy.Module):\n    def __init__(self):\n        self.retrieve = dspy.Retrieve(k=3)\n        self.generate = dspy.ChainOfThought(QA)\n\n    def forward(self, question):\n        context = self.retrieve(question).passages\n        return self.generate(context=context, question=question)\n\n# 3. Compile with an optimizer (automatic prompt engineering!)\ncompiled_rag = dspy.compile(\n    RAG(),\n    trainset=my_examples,\n    optimizer=dspy.BootstrapFewShot()\n)\n'})}),"\n",(0,s.jsx)(n.h3,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,s.jsxs)(n.h4,{id:"1-signatures---declare-your-task",children:["1. ",(0,s.jsx)(n.strong,{children:"Signatures"})," - Declare Your Task"]}),"\n",(0,s.jsxs)(n.p,{children:["Signatures are like ",(0,s.jsx)(n.strong,{children:"type signatures for LM operations"}),". They specify inputs, outputs, and the task description:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'class Summarize(dspy.Signature):\n    """Summarize a long document into key points."""\n    document = dspy.InputField()\n    key_points = dspy.OutputField(desc="bullet list of main ideas")\n'})}),"\n",(0,s.jsxs)(n.h4,{id:"2-modules---build-composable-pipelines",children:["2. ",(0,s.jsx)(n.strong,{children:"Modules"})," - Build Composable Pipelines"]}),"\n",(0,s.jsxs)(n.p,{children:["Modules are ",(0,s.jsx)(n.strong,{children:"PyTorch-style components"})," that can be:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Composed together"}),"\n",(0,s.jsx)(n.li,{children:"Optimized end-to-end"}),"\n",(0,s.jsx)(n.li,{children:"Reused across projects"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'class MultiHopQA(dspy.Module):\n    def __init__(self):\n        self.retrieve = dspy.Retrieve()\n        self.hop1 = dspy.ChainOfThought("context, question -> search_query")\n        self.hop2 = dspy.ChainOfThought("context, question -> answer")\n\n    def forward(self, question):\n        ctx1 = self.retrieve(question)\n        query = self.hop1(context=ctx1, question=question)\n        ctx2 = self.retrieve(query.search_query)\n        return self.hop2(context=ctx2, question=question)\n'})}),"\n",(0,s.jsxs)(n.h4,{id:"3-optimizers---automatic-prompt-and-weight-tuning",children:["3. ",(0,s.jsx)(n.strong,{children:"Optimizers"})," - Automatic Prompt and Weight Tuning"]}),"\n",(0,s.jsxs)(n.p,{children:["This is where ",(0,s.jsx)(n.strong,{children:"DSPy shines"}),". Optimizers automatically optimize your prompts:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"BootstrapFewShot"})}),": Generates effective few-shot examples"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"MIPRO"})}),": Optimizes instructions and demonstrations jointly"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"BootstrapFewShotWithRandomSearch"})}),": Explores prompt variations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"BayesianSignatureOptimizer"})}),": Uses Bayesian optimization"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# Before compilation: generic prompts\n# After compilation: optimized prompts with examples!\noptimizer = dspy.BootstrapFewShot(max_bootstrapped_demos=4)\ncompiled = optimizer.compile(student=my_module, trainset=examples)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"why-declarative-the-reactsql-analogy",children:"Why Declarative? The React/SQL Analogy"}),"\n",(0,s.jsxs)(n.p,{children:["Just as ",(0,s.jsx)(n.strong,{children:"React"})," revolutionized UI development and ",(0,s.jsx)(n.strong,{children:"SQL"})," revolutionized data queries, DSPy brings declarative thinking to LM programming:"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Imperative (Old)"}),(0,s.jsx)(n.th,{children:"Declarative (DSPy)"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Manually craft prompts"}),(0,s.jsx)(n.td,{children:"Declare signatures"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Hard-code examples"}),(0,s.jsx)(n.td,{children:"Auto-generate demos"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Trial and error tuning"}),(0,s.jsx)(n.td,{children:"Systematic optimization"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Brittle prompt strings"}),(0,s.jsx)(n.td,{children:"Composable modules"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"One-off solutions"}),(0,s.jsx)(n.td,{children:"Reusable components"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"React Example:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Imperative\nlet div = document.createElement('div');\ndiv.innerHTML = count;\nparent.appendChild(div);\n\n// Declarative\n<div>{count}</div>\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"DSPy Example:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# Imperative\nprompt = f"Given {context}, answer {question}"\nresponse = llm(prompt)\n\n# Declarative\nanswer = dspy.ChainOfThought("context, question -> answer")\n'})}),"\n",(0,s.jsx)(n.h3,{id:"real-world-use-cases",children:"Real-World Use Cases"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"RAG Systems"}),": Retrieval + reasoning pipelines - Complex question answering with multiple reasoning steps"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Data Extraction"}),": Extract structured data from unstructured text - Extract data from unstructured text"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Agentic Systems"}),": Build reliable LLM-based agents - Build agents that can perform tasks"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Classification"}),": Few-shot classification that improves over time - Classify data with few-shot examples"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"LLM-as-a-Judge"}),": Use LLMs to judge the quality of other LLMs' responses, align with human experts"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"dspy-architecture",children:"DSPy Architecture"}),"\n",(0,s.jsx)(a.A,{value:'\ngraph TB\n  subgraph "Your Code"\n      SIG[Signatures<br/>Define task I/O]\n      MOD[Modules<br/>Build pipeline]\n      DATA[Training Data<br/>Examples]\n  end\n\n  subgraph "DSPy Framework"\n      COMP[Compiler/Teleprompter]\n      OPT[Optimizer<br/>BootstrapFewShot, MIPRO]\n  end\n\n  subgraph "Output"\n      OPROM[Optimized Prompts<br/>with few-shot examples]\n      EXEC[Executable Program]\n  end\n\n  SIG --\x3e MOD\n  MOD --\x3e COMP\n  DATA --\x3e COMP\n  COMP --\x3e OPT\n  OPT --\x3e OPROM\n  OPROM --\x3e EXEC\n\n  style SIG fill:#E8B886,stroke:#D4A574\n  style MOD fill:#A8C5E0,stroke:#7FA8CC\n  style DATA fill:#F4A5A5,stroke:#E67878\n  style COMP fill:#B8D4A8,stroke:#8FBF76\n  style OPT fill:#F2C998,stroke:#E8B886\n  style OPROM fill:#FBF6EF,stroke:#D4A574\n  style EXEC fill:#D4A574,stroke:#BF8D56,color:#fff\n'}),"\n",(0,s.jsx)(n.h3,{id:"getting-started",children:"Getting Started"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"pip install dspy-ai\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import dspy\n\n# Configure your LM\nlm = dspy.OpenAI(model=\'gpt-4o\')\ndspy.settings.configure(lm=lm)\n\n# Define task\nclass Translate(dspy.Signature):\n    """Translate English to German."""\n    english = dspy.InputField()\n    german = dspy.OutputField()\n    instructions = dspy.InputField(desc="Instructions for the translation")\n\n# Use it\ntranslate = dspy.Predict(Translate)\nresult = translate(english="Around the World in 80 Days", instructions="Keep it short and concise like movie titles.")\nprint(result.german)  # "Um die Welt in 80 Tagen"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"when-tonot-to-use-dspy",children:"When to/not to use DSPy"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Use DSPy when:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Building complex LM pipelines"}),"\n",(0,s.jsx)(n.li,{children:"Need systematic optimization"}),"\n",(0,s.jsx)(n.li,{children:"Want composable, maintainable code"}),"\n",(0,s.jsx)(n.li,{children:"Switching between LM providers"}),"\n",(0,s.jsx)(n.li,{children:"Have training data to optimize with"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Skip DSPy when:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Simple one-off prompts"}),"\n",(0,s.jsx)(n.li,{children:"No training/validation data"}),"\n",(0,s.jsx)(n.li,{children:"Extremely domain-specific where manual control is critical"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"the-future-foundation-models-need-foundation-frameworks",children:"The Future: Foundation Models Need Foundation Frameworks"}),"\n",(0,s.jsx)(n.p,{children:"As foundation models become more powerful, we need foundation frameworks to build on them reliably. DSPy represents a shift from:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Prompt Engineering \u2192 Program Compilation"}),"\n",(0,s.jsx)(n.li,{children:"Trial and Error \u2192 Systematic Optimization"}),"\n",(0,s.jsx)(n.li,{children:"String Manipulation \u2192 Type-Safe Abstractions"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Just as we don't write assembly code anymore, we shouldn't manually craft prompts. DSPy brings software engineering best practices to the LLM era."}),"\n",(0,s.jsx)(n.h3,{id:"further-reading",children:"Further Reading"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\ud83d\udcda ",(0,s.jsx)(n.a,{href:"https://dspy.ai/",children:"DSPy Documentation"})]}),"\n",(0,s.jsxs)(n.li,{children:["\ud83d\udcbb ",(0,s.jsx)(n.a,{href:"https://github.com/stanfordnlp/dspy",children:"GitHub Repository"})]}),"\n",(0,s.jsxs)(n.li,{children:["\ud83d\udcc4 ",(0,s.jsx)(n.a,{href:"https://arxiv.org/abs/2310.03714",children:"Research Paper"})]}),"\n",(0,s.jsxs)(n.li,{children:["\ud83c\udf93 ",(0,s.jsx)(n.a,{href:"https://nlp.stanford.edu/",children:"Stanford NLP Group"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["DSPy isn't just another prompting library - it's a ",(0,s.jsx)(n.strong,{children:"paradigm shift"})," in how we program with language models.\nBy embracing declarative programming, we can build more reliable, maintainable, and performant LM applications."]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},2352(e,n,t){t.d(n,{A:()=>x});var i=t(6540),s=t(7489),r=t(2181),a=t(6342),o=t(5293);let l=null;async function d(){return l||(l=async function(){return(await t.e(3522).then(t.bind(t,3522))).default}()),l}function c(){const{colorMode:e}=(0,o.G)(),n=(0,a.p)().mermaid,t=n.theme[e],{options:s}=n;return(0,i.useMemo)(()=>({startOnLoad:!1,...s,theme:t}),[t,s])}function h({text:e,config:n}){const[t,s]=(0,i.useState)(null),r=(0,i.useState)(`mermaid-svg-${Math.round(1e7*Math.random())}`)[0],a=c(),o=n??a;return(0,i.useEffect)(()=>{(async function({id:e,text:n,config:t}){const i=await d();i.initialize(t);try{return await i.render(e,n)}catch(s){throw document.querySelector(`#d${e}`)?.remove(),s}})({id:r,text:e,config:o}).then(s).catch(e=>{s(()=>{throw e})})},[r,e,o]),t}const p="container_lyt7";var u=t(4848);function m({renderResult:e}){const n=(0,i.useRef)(null);return(0,i.useEffect)(()=>{const t=n.current;e.bindFunctions?.(t)},[e]),(0,u.jsx)("div",{ref:n,className:`docusaurus-mermaid-container ${p}`,dangerouslySetInnerHTML:{__html:e.svg}})}function g({value:e}){const n=h({text:e});return null===n?null:(0,u.jsx)(m,{renderResult:n})}function x(e){return(0,u.jsx)(s.A,{fallback:e=>(0,u.jsx)(r.MN,{...e}),children:(0,u.jsx)(g,{...e})})}},6404(e){e.exports=JSON.parse('{"permalink":"/blog/DSPy-Intro","editUrl":"https://github.com/jagan-shanmugam/jagan-shanmugam.github.io/tree/main/blog/2025-10-28-Intro to DSPy/index.mdx","source":"@site/blog/2025-10-28-Intro to DSPy/index.mdx","title":"Intro to DSPy","description":"Introduction to DSPy - Stanford NLP\'s declarative framework for programming with language models. Learn how to build composable, optimizable LM pipelines.","date":"2025-10-28T00:00:00.000Z","tags":[{"inline":true,"label":"dspy","permalink":"/blog/tags/dspy"},{"inline":true,"label":"llm","permalink":"/blog/tags/llm"},{"inline":true,"label":"ai","permalink":"/blog/tags/ai"},{"inline":true,"label":"language models","permalink":"/blog/tags/language-models"}],"readingTime":4.72,"hasTruncateMarker":true,"authors":[{"name":"Jagan Shanmugam","title":"Machine Learning Engineer & Data Scientist","url":"https://jagan-shanmugam.github.io","page":{"permalink":"/blog/authors/jagan"},"description":"Machine Learning Engineer passionate about AI, NLP, and building intelligent systems.","socials":{"x":"https://x.com/EeraVengayam","github":"https://github.com/jagan-shanmugam","linkedin":"https://www.linkedin.com/in/jaganshanmugam/"},"imageURL":"https://avatars.githubusercontent.com/u/30863630?v=4","key":"jagan"}],"frontMatter":{"slug":"DSPy-Intro","title":"Intro to DSPy","description":"Introduction to DSPy - Stanford NLP\'s declarative framework for programming with language models. Learn how to build composable, optimizable LM pipelines.","authors":["jagan"],"tags":["dspy","llm","ai","language models"],"keywords":["DSPy","language models","prompt optimization"]},"unlisted":false,"nextItem":{"title":"MCP Overview","permalink":"/blog/MCP-Overview"}}')},8453(e,n,t){t.d(n,{R:()=>a,x:()=>o});var i=t(6540);const s={},r=i.createContext(s);function a(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);